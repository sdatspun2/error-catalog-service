# Error Response in Error Catalog API

Error Catalog API uses [error.json](./models/error.json) and [error_instance.json](./models/error_instance.json) for error response.

Schema used for error response is derived from [Problem Details JSON Object](https://tools.ietf.org/html/rfc7807#section-3) as described in [RFC 7807](https://tools.ietf.org/html/rfc7807). Following sections describe individual members of `error.json` and `error_instance.json`. We also describe below where we have extended the Problem Details JSON Object and where we have diverged from it and why.

## error.json

### `type`

_type: string, uri, required_

A URI reference [RFC3986](https://tools.ietf.org/html/rfc3986) that identifies the problem type, as defined in RFC 7807. This specification encourages that, when dereferenced, it provides human-readable documentation for the problem type (e.g., using HTML [W3C.REC-html5-20141028](https://www.w3.org/TR/2014/REC-html5-20141028/)).  When this member is not present, its value is assumed to be "about:blank".

### `title`

_type: string, optional_

A short, human-readable summary of the problem type, as defined in RFC 7807.  It SHOULD NOT change from occurrence to occurrence of the problem, except for purposes of localization (e.g., using proactive content negotiation; see [RFC7231](https://tools.ietf.org/html/rfc7231), Section 3.4).

### `status`

_type: number, optional_

The HTTP status code [RFC7231](https://tools.ietf.org/html/rfc7231), Section 6) generated by the origin server for an occurrence of the problem, as defined in RFC 7807.

### `detail`

_type: string, optional_

A human-readable explanation specific to an occurrence of the problem, as defined in RFC 7807.

### `id` (extension)

_type: string, optional_

A unique reference for the problem instance for correlation purposes. This is an extension to the Problem Details JSON Object of RFC 7807.

### `links` (extension)

_type: array, optional_

Links providing more information related to problem.  This is an extension to the Problem Details JSON Object of RFC 7807. These links could point to FAQ or support pages providing help in order to resolve error situations.

### `instance` (not used)

_type: string, optional_

A URI reference that identifies the specific occurrence of the problem.  It may or may not yield further information if dereferenced.

We do not use this member of the Problem Details JSON Object of RFC7807. Instead, we use `instances` array as described below.

### `instances` (extension)

_type: array, optional_

We have used an array of error `instances` since `400` `Bad Request` types of status would require reporting more than one instances of the same problem type in an error response. Using the JSON type of `array` also works in cases where a single instance of a problem type is reported in the error response.  This is an extension to the Problem Details JSON Object of RFC 7807.

Following section describes the schema for an array element of `instances`.

## error_instance.json

Schema for [error_instance.json](./models/error_instance.json) is derived from standard validation output format as defined in [section 10](https://json-schema.org/draft/2019-09/json-schema-core.html#rfc.section.10) of JSON Schema specification.

### `keyword_location`

_type: string, optional_

Location of keyword entity involved in error. If the keyword is in the body, this will be JSON pointer to the property.

### `instance_location`

_type: string, optional_

The location of the error instance if qualification is needed beyond the `keyword_location`. Could be used to provide index of entry in array.

### `instance_value`

_type: string, optional_

The value of the keyword entity in error, if available.

### `in`

_type: string, required_

The location of the type of entity that is in error. Valid values are `body`, `path`, or `query`. Default is `body`.

### `detail`

_type: string, required_

Error message for entity in error. It is recommended that this value is not hardcoded but instead injected from relevant entry (with template string) in the error catalog.

### `instance`

_type: string, uri, optional_

A URI reference that identifies the specific occurrence of the problem. It may or may not yield further information if dereferenced. This member is from RFC 7807 but it is moved to an entity in array of `instances`.


## References

1. [Problem Details for HTTP APIs, RFC 7807](https://tools.ietf.org/html/rfc7807)
2. [JSON Schema Core](https://json-schema.org/draft/2019-09/json-schema-core.html)
